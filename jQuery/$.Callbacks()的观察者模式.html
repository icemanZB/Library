<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="UTF-8">
	<title>$.Callbacks()</title>
	<script src="js/jquery-2.0.3.min.js"></script>
	<script>
		// 观察者模式
		var observer = {
			hash     : {},
			subscribe: function (id, callback) {
				if (typeof id !== "string") {
					return;
				}
				if (!this.hash[id]) {
					this.hash[id] = $.Callbacks();
					this.hash[id].add(callback);
				} else {
					this.hash[id].add(callback);
				}
			},
			publish  : function (id) {
				if (!this.hash[id]) {
					return;
				}
				this.hash[id].fire(id);
			}
		};

		// 订阅
		observer.subscribe("mailArrived", function () {
			console.log("来信了");
		});
		observer.subscribe("mailArrived", function () {
			console.log("又来信了");
		});
		observer.subscribe("mailSend", function () {
			console.log("发信成功");
		});

		// 发布
		setTimeout(function () {
			observer.publish("mailArrived");
		}, 5000);

		setTimeout(function () {
			observer.publish("mailSend");
		}, 10000);

	</script>
</head>
<body>

</body>
</html>